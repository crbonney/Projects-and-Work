% Chris Bonney (July 2021) %% Program Startclear allclose allclcformat short e% add my set of functions to pathaddpath('functions')PID.name = 'PID';%% Plant Data% Controller ConstantsKa=-0.0015;Kq=-0.32;az=2;aq=6;% Dynamics ConstantsV=886.78;Za=-1.3046*V;Zd=-0.2142*V;Ma=47.7109;Md=-104.8346;% Actuator Constantsomega = 2.*pi*11;zeta = sqrt(1/2);%% Dynamics without actuatorAp = [Za/V  1  ;       Ma   0 ];Bp = [Zd/V ;       Md ];Cp = [1 0  ;      0  1 ];Dp = [0 ;      0 ];PID.DesignPlant = ss(Ap,Bp,Cp,Dp);% Size of the plant model[nx,~]=size(Ap);%% Dynamics with ActuatorA_actuator = [0 1; -omega^2 -2*zeta*omega];B_actuator = [0; omega^2];Plant.Ap = [   Ap      Bp zeros(2,1);             zeros(2,2)  A_actuator];Plant.Bp = [zeros(2,1); B_actuator];Plant.Cp = [Za 0 Zd 0;             eye(4)];Plant.Dp = 0*(Plant.Cp*Plant.Bp);Ap = Plant.Ap;Bp = Plant.Bp;Cp = Plant.Cp;Dp = Plant.Dp;##PID.AnalysisPlant = ss(Ap,Bp,Cp,Dp);PID.AnalysisPlant = PID.DesignPlant;PID.Pvalues = logspace(1,3,10);#linspace(0.5,1,5);PID.Ivalues = 1;#linspace(10e-3,14e-3,5);PID.Dvalues = 1;#linspace(4e-1,8e-1,5);%% Design PID controller% paramaters: % controller model, analysis model, ...% 3D array of values for PID coefficients, and the system structurePID = design_pid(PID.DesignPlant,PID.AnalysisPlant,PID.Pvalues,PID.Ivalues,PID.Dvalues,PID);% AZ TIME HISTORIES OF PID CONTROLLERSfigure('Name','PID Time Histories')hold onfor i = 1:length(PID.Pvalues)  for j = 1:length(PID.Ivalues)    for k = 1:length(PID.Dvalues)      if(size(PID.Design_data(i,j,k).y) > 0)        plot(PID.t,PID.Design_data(i,j,k).y(:,1));      end    end  endendbest_plot = plot(PID.t,PID.y(:,1),'r','LineWidth',2);xlabel('time (sec)');ylabel('Position (m)');legend(best_plot,'Best PID','Location','best');title('PID Time Histories');##% Rise and Settle Time of PID Controllers##figure('Name','PID Rise and Settle Times')##hold on##for i = 1:length(PID.Pvalues)##  for j = 1:length(PID.Ivalues)####    for k = 1:length(PID.Dvalues)####      if(size(PID.Design_data(i,j,k).y) > 0)##        plot([PID.Design_data(i,j,:).settletime],[PID.Design_data(i,j,:).risetime],'.-','markersize',10);####      end####    end##  end##end##best_plot = plot(PID.settletime,PID.risetime,'ro','linewidth',5,'markersize',10);##xlabel('Settle Time (s)');##ylabel('Rise Time (s)');##legend(best_plot,'Best PID','Location','best');##title('PID Rise and Settle Times');print_analysis(PID)%% saves design data to a .mat filesave('PID_design.mat','PID');